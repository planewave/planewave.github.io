<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="FFT-Based FIR Filtering Using Overlap-Add Method: a Matlab Implementation" /><meta property="og:locale" content="en" /><meta name="description" content="You have a very long signal, and you want to filter it with an FIR filter. The signal can be a stream of radio or audio, and you are going to implement it on a resource-constrained device, an FPGA or an MCU. This looks like a simple task for newbies, what could be wrong?" /><meta property="og:description" content="You have a very long signal, and you want to filter it with an FIR filter. The signal can be a stream of radio or audio, and you are going to implement it on a resource-constrained device, an FPGA or an MCU. This looks like a simple task for newbies, what could be wrong?" /><link rel="canonical" href="https://planewave.github.io/posts/fir-fft/" /><meta property="og:url" content="https://planewave.github.io/posts/fir-fft/" /><meta property="og:site_name" content="Xiaoâ€™s Spectrum of Life" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-05-24T16:00:00-07:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="FFT-Based FIR Filtering Using Overlap-Add Method: a Matlab Implementation" /><meta name="twitter:site" content="@twitter_username" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"description":"You have a very long signal, and you want to filter it with an FIR filter. The signal can be a stream of radio or audio, and you are going to implement it on a resource-constrained device, an FPGA or an MCU. This looks like a simple task for newbies, what could be wrong?","url":"https://planewave.github.io/posts/fir-fft/","@type":"BlogPosting","headline":"FFT-Based FIR Filtering Using Overlap-Add Method: a Matlab Implementation","dateModified":"2022-05-29T10:52:04-07:00","datePublished":"2022-05-24T16:00:00-07:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://planewave.github.io/posts/fir-fft/"},"@context":"https://schema.org"}</script><title>FFT-Based FIR Filtering Using Overlap-Add Method: a Matlab Implementation | Xiao's Spectrum of Life</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Xiao's Spectrum of Life"><meta name="application-name" content="Xiao's Spectrum of Life"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/commons/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Xiao's Spectrum of Life</a></div><div class="site-subtitle font-italic">Grow, seek truth courage and wisdom</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/planewave" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://www.linkedin.com/in/xiao-liu-phd" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['exclaim-flip-kooky','duck.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>FFT-Based FIR Filtering Using Overlap-Add Method: a Matlab Implementation</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>FFT-Based FIR Filtering Using Overlap-Add Method: a Matlab Implementation</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/planewave">Xiao Liu</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" date="2022-05-24 16:00:00 -0700" data-toggle="tooltip" data-placement="bottom" title="Tue, May 24, 2022, 4:00 PM -0700" >May 24, 2022</em> </span> <span> Updated <em class="timeago" date="2022-05-29 10:52:04 -0700 " data-toggle="tooltip" data-placement="bottom" title="Sun, May 29, 2022, 10:52 AM -0700" >May 29, 2022</em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="842 words"> <em>4 min</em> read</span></div></div></div><div class="post-content"><p>You have a very long signal, and you want to filter it with an FIR filter. The signal can be a stream of radio or audio, and you are going to implement it on a resource-constrained device, an FPGA or an MCU. This looks like a simple task for newbies, what could be wrong?</p><h2 id="the-memory-is-limited">The Memory is Limited <a href="#the-memory-is-limited" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>A common mistake beginners make is loading the entire signal to the memory and then filtering it. This could work in Matlab, but there are many issues when implementing it on real hardware. First, the signal can be very long, and the memory (or registers in an FPGA) is limited. The memory is precious, and you donâ€™t want to eat it all up and crash your device.</p><p>Second, it is a waste of time if you start the filtering until the end of the signal stream. The normal way to do it is once a block of the signal is ready, you filter it, and then you wait for the next block. It can be considered a producer-consumer problem, and there are standard implementations in each language.</p><h2 id="overlap-add-method">Overlap-Add Method <a href="#overlap-add-method" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>We know that the DFT provides an efficient way to compute the convolution (or linear filtering) of two signals in the frequency domain (go back to any DSP textbook if you donâ€™t know about it). To filter a very long sequence, two DFT-based approaches are the overlap-add method and the overlap-save method. Both of them break the signal into blocks and then compute the convolution of each block independently, and then combine the results in a certain way. We will only discuss the overlap-add method here and focus on the implementation in Matlab.</p><p>The theory and how it accelerates the filtering can be found in <a href="https://www.allaboutcircuits.com/technical-articles/overlap-add-method-linear-filtering-based-on-the-discrete-fourier-transform/">this blog post</a>. The general steps are</p><ol><li>find out the optimal NFFT and signal block size based on the FIR filter length.<li>convert the FIR filter to the frequency domain. and initialize the output signal.<li>loop each block of the signal, convert it to the frequency domain, and compute the dot product of the frequency domain of the FIR filter and the frequency domain of the signal block.<li>convert back the result to the time domain, and add it to the output signal with an overlap.</ol><h2 id="the-matlab-implementation">The Matlab Implementation <a href="#the-matlab-implementation" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>Note that this code is modified from the Matlab function <code class="language-plaintext highlighter-rouge">fftfilt</code> in the <a href="https://www.mathworks.com/help/signal/ref/fftfilt.html">Matlab Signal Processing Toolbox</a>. I made it more readable and easy to understand, and I also added some comments to explain the code.</p><div class="language-matlab highlighter-rouge"><div class="code-header"> <span data-label-text="Matlab"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
</pre><td class="rouge-code"><pre><span class="k">function</span> <span class="n">y</span> <span class="o">=</span> <span class="n">fft_filter</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
    <span class="c1">%   Overlap-add method for FIR filtering using FFT.</span>
    <span class="c1">%   y = fft_filter(b,x) filters x, with the FIR filter specified by the </span>
    <span class="c1">%   coefficients b, using the overlap/add method, and internal</span>
    <span class="c1">%   parameters (FFT size and block length) that guarantee efficient</span>
    <span class="c1">%   execution.</span>
    
    
    <span class="c1">% Check validity of input</span>
    <span class="c1">% I found it extremely useful to check the validity of the input</span>
    <span class="c1">% and to make the code more readable. no need to write a group of </span>
    <span class="c1">% if-else statements anymore.</span>
    <span class="c1">% here I require the input to be a column vector.</span>
    <span class="nb">validateattributes</span><span class="p">(</span><span class="n">b</span><span class="p">,{</span><span class="s1">'double'</span><span class="p">},{</span><span class="s1">'column'</span><span class="p">},</span><span class="s1">'fft_filter'</span><span class="p">,</span><span class="s1">'B'</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
    <span class="nb">validateattributes</span><span class="p">(</span><span class="n">x</span><span class="p">,{</span><span class="s1">'double'</span><span class="p">},{</span><span class="s1">'column'</span><span class="p">},</span><span class="s1">'fft_filter'</span><span class="p">,</span><span class="s1">'X'</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>

    <span class="c1">% count the number of element for x and b</span>
        <span class="n">nx</span> <span class="o">=</span> <span class="nb">size</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
        <span class="n">nb</span> <span class="o">=</span> <span class="nb">size</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>

    <span class="c1">% determine the most efficient NFFT</span>
    <span class="k">if</span> <span class="n">nb</span> <span class="o">&gt;=</span> <span class="n">nx</span> <span class="o">||</span> <span class="n">nb</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="o">^</span><span class="mi">20</span>              <span class="c1">% take a single FFT in this case</span>
        <span class="n">nfft</span> <span class="o">=</span> <span class="mi">2</span><span class="o">^</span><span class="nb">nextpow2</span><span class="p">(</span><span class="n">nb</span> <span class="o">+</span> <span class="n">nx</span> <span class="o">-</span><span class="mi">1</span><span class="p">);</span>    <span class="c1">% 2^ceil(log2(nb + nx -1))</span>
        <span class="n">blockLen</span> <span class="o">=</span> <span class="n">nx</span><span class="p">;</span>
    <span class="k">else</span>
        <span class="c1">% this is the computation cost of the FFT for each NFFT</span>
        <span class="n">fftflops</span> <span class="o">=</span> <span class="p">[</span> <span class="mi">18</span> <span class="mi">59</span> <span class="mi">138</span> <span class="mi">303</span> <span class="mi">660</span> <span class="mi">1441</span> <span class="mi">3150</span> <span class="mi">6875</span> <span class="mi">14952</span> <span class="mi">32373</span> <span class="mi">69762</span> <span class="k">...</span>
            <span class="mi">149647</span> <span class="mi">319644</span> <span class="mi">680105</span> <span class="mi">1441974</span> <span class="mi">3047619</span> <span class="mi">6422736</span> <span class="mi">13500637</span> <span class="mi">28311786</span> <span class="k">...</span>
            <span class="mi">59244791</span> <span class="mi">59244791</span><span class="o">*</span><span class="mf">2.09</span><span class="p">];</span>
        <span class="n">nfftList</span> <span class="o">=</span> <span class="mf">2.</span><span class="o">^</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">21</span><span class="p">);</span>
        <span class="n">nfftValid</span> <span class="o">=</span> <span class="n">nfftList</span><span class="p">(</span><span class="n">nfftList</span> <span class="o">&gt;</span> <span class="n">nb</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
        <span class="n">fftflopsValid</span> <span class="o">=</span> <span class="n">fftflops</span><span class="p">(</span><span class="n">nfftList</span> <span class="o">&gt;</span> <span class="n">nb</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
        <span class="c1">% NFFT = blockLen + nb - 1, to avoid circular convolution</span>
        <span class="n">blockLenList</span> <span class="o">=</span> <span class="n">nfftValid</span> <span class="o">-</span> <span class="p">(</span><span class="n">nb</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
        <span class="c1">% minimize (number of blocks) * (number of flops per fft)</span>
        <span class="p">[</span><span class="o">~</span><span class="p">,</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">ceil</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="p">/</span><span class="n">blockLenList</span><span class="p">)</span><span class="o">.*</span><span class="n">fftflopsValid</span><span class="p">);</span>
        <span class="n">nfft</span> <span class="o">=</span> <span class="n">nfftValid</span><span class="p">(</span><span class="n">ind</span><span class="p">);</span>               <span class="c1">% must have nfft &gt; (nb-1)</span>
        <span class="n">blockLen</span> <span class="o">=</span> <span class="n">blockLenList</span><span class="p">(</span><span class="n">ind</span><span class="p">);</span>
    <span class="k">end</span>
    
    <span class="n">B</span> <span class="o">=</span> <span class="nb">fft</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="n">nfft</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
    <span class="c1">% init output y</span>
    <span class="n">y</span> <span class="o">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="nb">size</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s1">'like'</span><span class="p">,</span><span class="mi">1</span><span class="o">+</span><span class="mi">1</span><span class="n">i</span><span class="p">);</span>
    <span class="n">istart</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="c1">% main loop for the overlap-add method</span>
    <span class="c1">% this is a good example how to take care of the edge case</span>
    <span class="k">while</span> <span class="n">istart</span> <span class="o">&lt;=</span> <span class="n">nx</span>
        <span class="n">iend</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">istart</span><span class="o">+</span><span class="n">blockLen</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">nx</span><span class="p">);</span>
        <span class="n">X</span> <span class="o">=</span> <span class="nb">fft</span><span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="n">istart</span><span class="p">:</span><span class="n">iend</span><span class="p">,:),</span><span class="n">nfft</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
        <span class="n">yblock</span> <span class="o">=</span> <span class="nb">ifft</span><span class="p">(</span><span class="n">X</span><span class="o">.*</span><span class="n">B</span><span class="p">,[],</span><span class="mi">1</span><span class="p">);</span>
        <span class="n">yend</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">nx</span><span class="p">,</span><span class="n">istart</span><span class="o">+</span><span class="n">nfft</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
        <span class="n">y</span><span class="p">(</span><span class="n">istart</span><span class="p">:</span><span class="n">yend</span><span class="p">,:)</span> <span class="o">=</span> <span class="n">y</span><span class="p">(</span><span class="n">istart</span><span class="p">:</span><span class="n">yend</span><span class="p">,:)</span> <span class="o">+</span> <span class="n">yblock</span><span class="p">(</span><span class="mi">1</span><span class="p">:(</span><span class="n">yend</span><span class="o">-</span><span class="n">istart</span><span class="o">+</span><span class="mi">1</span><span class="p">),:);</span>
        <span class="n">istart</span> <span class="o">=</span> <span class="n">istart</span> <span class="o">+</span> <span class="n">blockLen</span><span class="p">;</span>
    <span class="k">end</span>

    <span class="c1">% let the output be real if the input is real</span>
    <span class="k">if</span> <span class="nb">isreal</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nb">isreal</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="nb">real</span><span class="p">(</span><span class="n">y</span><span class="p">);</span>
    <span class="k">end</span>

<span class="k">end</span>
</pre></table></code></div></div><p>In this post, we not only reviewed a divide-and-conquer way to deal with long signals but also implemented the overlap-add method in Matlab. I hope you can learn one or two coding tricks from this post too.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/dsp-essentials/'>DSP essentials</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/dsp/" class="post-tag no-text-decoration" >dsp</a> <a href="/tags/fft/" class="post-tag no-text-decoration" >fft</a> <a href="/tags/fir/" class="post-tag no-text-decoration" >fir</a> <a href="/tags/overlap-add/" class="post-tag no-text-decoration" >overlap-add</a> <a href="/tags/matlab/" class="post-tag no-text-decoration" >matlab</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=FFT-Based FIR Filtering Using Overlap-Add Method: a Matlab Implementation - Xiao's Spectrum of Life&url=https://planewave.github.io/posts/fir-fft/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=FFT-Based FIR Filtering Using Overlap-Add Method: a Matlab Implementation - Xiao's Spectrum of Life&u=https://planewave.github.io/posts/fir-fft/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=FFT-Based FIR Filtering Using Overlap-Add Method: a Matlab Implementation - Xiao's Spectrum of Life&url=https://planewave.github.io/posts/fir-fft/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recent Update</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Chinese-new-year/">é™¤å¤•å¤œçš„å›žå¿†</a><li><a href="/posts/new-year/">Happy New Year!</a><li><a href="/posts/rf-impairment-2/">Understanding RF Impairments - Part 2</a><li><a href="/posts/fir-fft/">FFT-Based FIR Filtering Using Overlap-Add Method: a Matlab Implementation</a><li><a href="/posts/spectrum1/">Power Spectrum: something I wish I could understand early (1)</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/dsp/">dsp</a> <a class="post-tag" href="/tags/matlab/">matlab</a> <a class="post-tag" href="/tags/interview/">interview</a> <a class="post-tag" href="/tags/impairment/">Impairment</a> <a class="post-tag" href="/tags/power-spectrum/">power spectrum</a> <a class="post-tag" href="/tags/ads-b/">ads-b</a> <a class="post-tag" href="/tags/nonlinear/">nonlinear</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/sampling/">sampling</a> <a class="post-tag" href="/tags/transceiver/">transceiver</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/spectrum2/"><div class="card-body"> <em class="timeago small" date="2022-02-12 02:00:00 -0800" >Feb 12, 2022</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Power Spectrum: something I wish I could understand early (2)</h3><div class="text-muted small"><p> Real and complex signals When doing the spectrum analysis, the signal is usually real-valued. However, when studying the baseband signal in wireless communications, the data is complex-valued. The...</p></div></div></a></div><div class="card"> <a href="/posts/spectrum3/"><div class="card-body"> <em class="timeago small" date="2022-02-19 08:00:00 -0800" >Feb 19, 2022</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Power Spectrum: something I wish I could understand early (3)</h3><div class="text-muted small"><p> In this post, I am going to share a set of Python functions that can calculate the power spectral density, spectrogram, and persistence spectrum of a given (real or complex) one-dimensional signal....</p></div></div></a></div><div class="card"> <a href="/posts/polyphase-decimator/"><div class="card-body"> <em class="timeago small" date="2022-04-23 02:00:00 -0700" >Apr 23, 2022</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Polyphase FIR Filter Downsampling</h3><div class="text-muted small"><p> This is a long-delayed post. As a father of two, who is living in one of the most expensive cities in the world, life is full of challenges. In most cases, after decomposition, they always go down ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/matlab-vscode/" class="btn btn-outline-primary" prompt="Older"><p>Matlab Development in Visual Studio Code</p></a> <a href="/posts/getopt/" class="btn btn-outline-primary" prompt="Newer"><p>A Simple Parser in C Using Getopt</p></a></div><div id="disqus_thread" class="pt-2 pb-2"><p class="text-center text-muted small"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script type="text/javascript"> var disqus_config = function () { this.page.url = 'https://planewave.github.io/posts/fir-fft/'; this.page.identifier = '/posts/fir-fft/'; }; /* Lazy loading */ var disqus_observer = new IntersectionObserver(function (entries) { if(entries[0].isIntersecting) { (function () { var d = document, s = d.createElement('script'); s.src = 'https://planewave-github-io.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); disqus_observer.disconnect(); } }, { threshold: [0] }); disqus_observer.observe(document.querySelector('#disqus_thread')); /* Auto switch theme */ function reloadDisqus() { /* Disqus hasn't been loaded */ if (typeof DISQUS === "undefined") { return; } if (document.readyState == 'complete') { DISQUS.reset({ reload: true, config: disqus_config }); } } const modeToggle = document.querySelector(".mode-toggle"); if (typeof modeToggle !== "undefined") { /* modeToggle.addEventListener('click', reloadDisqus); // not pretty for 'color-scheme' */ window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', reloadDisqus); } </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> Â© 2025 <a href="https://github.com/planewave">Xiao Liu</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/dsp/">dsp</a> <a class="post-tag" href="/tags/matlab/">matlab</a> <a class="post-tag" href="/tags/interview/">interview</a> <a class="post-tag" href="/tags/impairment/">Impairment</a> <a class="post-tag" href="/tags/power-spectrum/">power spectrum</a> <a class="post-tag" href="/tags/ads-b/">ads-b</a> <a class="post-tag" href="/tags/nonlinear/">nonlinear</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/sampling/">sampling</a> <a class="post-tag" href="/tags/transceiver/">transceiver</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-GVBM7G9LZ5"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-GVBM7G9LZ5'); }); </script>
