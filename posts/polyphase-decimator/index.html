<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="Polyphase FIR Filter Downsampling" /><meta property="og:locale" content="en" /><meta name="description" content="This is a long-delayed post. As a father of two, who is living in one of the most expensive cities in the world, life is full of challenges. In most cases, after decomposition, they always go down to two reasons: the lack of money and/or time. It’s a simple truth, but I took years to realize it. Many years ago when I started writing DSP code, all I cared about was the correctness. My code used to have no readability, no structure, and no efficiency. Especially, when using Matlab, I used to pay no attention to the memory or CPU resource allocation, unless it is a heavy task or is going to be implemented on the hardware." /><meta property="og:description" content="This is a long-delayed post. As a father of two, who is living in one of the most expensive cities in the world, life is full of challenges. In most cases, after decomposition, they always go down to two reasons: the lack of money and/or time. It’s a simple truth, but I took years to realize it. Many years ago when I started writing DSP code, all I cared about was the correctness. My code used to have no readability, no structure, and no efficiency. Especially, when using Matlab, I used to pay no attention to the memory or CPU resource allocation, unless it is a heavy task or is going to be implemented on the hardware." /><link rel="canonical" href="https://planewave.github.io/posts/polyphase-decimator/" /><meta property="og:url" content="https://planewave.github.io/posts/polyphase-decimator/" /><meta property="og:site_name" content="Xiao’s Spectrum of Life" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-04-23T02:00:00-07:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Polyphase FIR Filter Downsampling" /><meta name="twitter:site" content="@twitter_username" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"description":"This is a long-delayed post. As a father of two, who is living in one of the most expensive cities in the world, life is full of challenges. In most cases, after decomposition, they always go down to two reasons: the lack of money and/or time. It’s a simple truth, but I took years to realize it. Many years ago when I started writing DSP code, all I cared about was the correctness. My code used to have no readability, no structure, and no efficiency. Especially, when using Matlab, I used to pay no attention to the memory or CPU resource allocation, unless it is a heavy task or is going to be implemented on the hardware.","url":"https://planewave.github.io/posts/polyphase-decimator/","@type":"BlogPosting","headline":"Polyphase FIR Filter Downsampling","dateModified":"2022-05-18T21:26:33-07:00","datePublished":"2022-04-23T02:00:00-07:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://planewave.github.io/posts/polyphase-decimator/"},"@context":"https://schema.org"}</script><title>Polyphase FIR Filter Downsampling | Xiao's Spectrum of Life</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Xiao's Spectrum of Life"><meta name="application-name" content="Xiao's Spectrum of Life"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/commons/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Xiao's Spectrum of Life</a></div><div class="site-subtitle font-italic">Grow, seek truth courage and wisdom</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/planewave" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://www.linkedin.com/in/xiao-liu-phd" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['exclaim-flip-kooky','duck.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Polyphase FIR Filter Downsampling</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Polyphase FIR Filter Downsampling</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/planewave">Xiao Liu</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" date="2022-04-23 02:00:00 -0700" data-toggle="tooltip" data-placement="bottom" title="Sat, Apr 23, 2022, 2:00 AM -0700" >Apr 23, 2022</em> </span> <span> Updated <em class="timeago" date="2022-05-18 21:26:33 -0700 " data-toggle="tooltip" data-placement="bottom" title="Wed, May 18, 2022, 9:26 PM -0700" >May 18, 2022</em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="742 words"> <em>4 min</em> read</span></div></div></div><div class="post-content"><p>This is a long-delayed post. As a father of two, who is living in one of the most expensive cities in the world, life is full of challenges. In most cases, after decomposition, they always go down to two reasons: the lack of money and/or time. It’s a simple truth, but I took years to realize it. Many years ago when I started writing DSP code, all I cared about was the correctness. My code used to have no readability, no structure, and no efficiency. Especially, when using Matlab, I used to pay no attention to the memory or CPU resource allocation, unless it is a heavy task or is going to be implemented on the hardware.</p><p>Therefore, I want to write a series of posts on how to efficiently implement some DSP algorithms. I am going to start with the polyphase FIR filter downsampling.</p><h2 id="conventional-downsampling">Conventional downsampling <a href="#conventional-downsampling" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>Downsampling normally means reducing the sampling rate of a given digital signal by an integer factor $M$. According to the <a href="https://en.wikipedia.org/wiki/Nyquist–Shannon_sampling_theorem">sampling theorem</a>, we can not downsample a signal simply by keeping every Mth sample. Otherwise, there will be aliasing, or in other words, high-frequency components will be mixed into the downsampling output. Therefore, before decimation, a low pass filter (<a href="https://en.wikipedia.org/wiki/Anti-aliasing_filter">anti-aliasing filter</a>) is required to remove the high-frequency components.</p><p><img data-src="/assets/img/posts/firdecimationfilter.png" alt="fir decimation filter" data-proofer-ignore></p><p>The anti-aliasing filter is normally an FIR filter. If the length of the filter is <code class="language-plaintext highlighter-rouge">fir_len</code>, to output one sample, we will need <code class="language-plaintext highlighter-rouge">fir_len</code> multiplications. The multiplication cannot be shared between samples, so if the length of the signal is <code class="language-plaintext highlighter-rouge">sig_len</code>, it requires <code class="language-plaintext highlighter-rouge">fir_len * sig_len</code> multiplications. However, after decimation, only <code class="language-plaintext highlighter-rouge">sig_len / M</code> samples are left, which means, the effective number of multiplications is <code class="language-plaintext highlighter-rouge">fir_len * sig_len / M</code>, and other multiplications are wasted.</p><h2 id="polyphase-fir-filter-downsampling">Polyphase FIR filter downsampling <a href="#polyphase-fir-filter-downsampling" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>The most interesting part of polyphase FIR filter downsampling is that it downsamples the signal first and then does the filtering, such that the multiplications are applied only to the leftover samples.</p><p>As always, Matlab has a <a href="https://www.mathworks.com/help/dsp/ref/dsp.firdecimator-system-object.html#bsfxw05_sep_bsfxw05-6">document</a> to explain this algorithm. This reversed order of downsampling (or upsampling) and filtering is called <em>multirate noble identity</em>. I am not going to past all the equations and plots here, but to explain the idea.</p><p>The polyphase FIR filter downsampling is a new structure. It is a <a href="https://en.wikipedia.org/wiki/Decimator">decimator</a> that is implemented using a <a href="https://en.wikipedia.org/wiki/Polyphase_filter">polyphase filter</a>. The first step of downsampling is to split the signal into $M$ sub-signals, and each sub-signal is a downsampled version of the original signal, so there is no sample discarded as the conventional downsampling. The second step is to filter each sub-signal with a sub-filter. Just like the sub-signals, the sub-filters are downsampled versions of the original low-pass FIR filter. The initial sample (or phase) when downsampling the low-pass filter is different for each sub-filter. That is why the sub-filters are called <em>polyphase filters</em>.</p><h2 id="illustration-and-demo-code">Illustration and demo code <a href="#illustration-and-demo-code" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>There is an example of a polyphase FIR filter downsampling in the following figure, where the signal is downsampled by a factor of $M = 3$. The impulse response of the low-pass FIR filter is $h$, and for demonstration purposes, its length <code class="language-plaintext highlighter-rouge">fir_len</code> is set to 6. The input signal $x$ is split by a commutator switch as shown below.</p><p><img data-src="/assets/img/posts/polyphase_downsampling.jpg" alt="polyphase downsampling" data-proofer-ignore></p><p>The demo code is as follows. The input signal $x$ and the impulse response $h$ are defined for demonstration purposes. <code class="language-plaintext highlighter-rouge">dsp.FIRDecimator</code> is a Matlab built-in object that implements the polyphase FIR filter downsampling. We can see that our output <code class="language-plaintext highlighter-rouge">y_polyphase</code> is the same as the reference output <code class="language-plaintext highlighter-rouge">y_ref</code>.</p><div class="language-matlab highlighter-rouge"><div class="code-header"> <span data-label-text="Matlab"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
</pre><td class="rouge-code"><pre><span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="mi">11</span><span class="p">)</span><span class="o">'</span><span class="p">;</span>
<span class="n">M</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
<span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">)</span><span class="o">'</span><span class="p">;</span>
<span class="c1">% use Matlab built-in function</span>
<span class="n">firdecim</span> <span class="o">=</span> <span class="n">dsp</span><span class="o">.</span><span class="n">FIRDecimator</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">h</span><span class="p">);</span>
<span class="n">y_ref</span> <span class="o">=</span> <span class="n">firdecim</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>

<span class="n">fir_len</span> <span class="o">=</span> <span class="nb">length</span><span class="p">(</span><span class="n">h</span><span class="p">);</span>
<span class="c1">% if the fir_len is not intger multiple of fir_len, padding zeros</span>
<span class="k">if</span> <span class="p">(</span><span class="nb">rem</span><span class="p">(</span><span class="n">fir_len</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span> <span class="o">~=</span> <span class="mi">0</span><span class="p">)</span>
     <span class="n">nzeros</span> <span class="o">=</span> <span class="n">M</span> <span class="o">-</span> <span class="nb">rem</span><span class="p">(</span><span class="n">fir_len</span><span class="p">,</span> <span class="n">M</span><span class="p">);</span>
     <span class="n">h</span> <span class="o">=</span> <span class="p">[</span><span class="n">h</span><span class="p">;</span> <span class="nb">zeros</span><span class="p">(</span><span class="n">nzeros</span><span class="p">,</span><span class="mi">1</span><span class="p">)];</span>  
<span class="k">end</span>
<span class="n">len</span> <span class="o">=</span> <span class="nb">length</span><span class="p">(</span><span class="n">h</span><span class="p">);</span>
<span class="n">ncolm</span> <span class="o">=</span> <span class="n">len</span> <span class="p">/</span> <span class="n">M</span><span class="p">;</span>

<span class="n">polyphase_filt</span> <span class="o">=</span> <span class="nb">flipud</span><span class="p">(</span><span class="nb">reshape</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">ncolm</span><span class="p">));</span>

<span class="c1">% init output</span>
<span class="n">nx</span> <span class="o">=</span> <span class="nb">length</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
<span class="n">y_polyphase</span> <span class="o">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="nb">floor</span><span class="p">((</span><span class="n">nx</span><span class="o">-</span><span class="mi">1</span><span class="p">)/</span><span class="n">M</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="n">y_polyphase</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">polyphase_filt</span><span class="p">(</span><span class="k">end</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

<span class="c1">% init filter register to store x</span>
<span class="n">filt_reg</span> <span class="o">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="nb">size</span><span class="p">(</span><span class="n">polyphase_filt</span><span class="p">));</span>
<span class="n">filt_reg</span><span class="p">(</span><span class="k">end</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>

<span class="k">for</span> <span class="n">idx</span> <span class="o">=</span> <span class="mi">2</span><span class="p">:</span><span class="nb">length</span><span class="p">(</span><span class="n">y_polyphase</span><span class="p">)</span>
    <span class="n">xst</span> <span class="o">=</span> <span class="p">(</span><span class="n">idx</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">M</span> <span class="o">+</span> <span class="mi">2</span><span class="p">;</span>
    <span class="n">filt_reg</span><span class="p">(:,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">x</span><span class="p">(</span><span class="n">xst</span><span class="p">:</span><span class="n">xst</span><span class="o">+</span><span class="n">M</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
    <span class="n">y_polyphase</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">polyphase_filt</span> <span class="o">.*</span> <span class="n">filt_reg</span><span class="p">,</span> <span class="s1">'all'</span><span class="p">);</span>
    <span class="n">filt_reg</span> <span class="o">=</span> <span class="nb">circshift</span><span class="p">(</span><span class="n">filt_reg</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
<span class="k">end</span>
</pre></table></code></div></div><p>That is all for this post. Hope you enjoy it.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/dsp-essentials/'>DSP essentials</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/dsp/" class="post-tag no-text-decoration" >dsp</a> <a href="/tags/polyphase/" class="post-tag no-text-decoration" >polyphase</a> <a href="/tags/sampling/" class="post-tag no-text-decoration" >sampling</a> <a href="/tags/matlab/" class="post-tag no-text-decoration" >matlab</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Polyphase FIR Filter Downsampling - Xiao's Spectrum of Life&url=https://planewave.github.io/posts/polyphase-decimator/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Polyphase FIR Filter Downsampling - Xiao's Spectrum of Life&u=https://planewave.github.io/posts/polyphase-decimator/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Polyphase FIR Filter Downsampling - Xiao's Spectrum of Life&url=https://planewave.github.io/posts/polyphase-decimator/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recent Update</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Chinese-new-year/">除夕夜的回忆</a><li><a href="/posts/new-year/">Happy New Year!</a><li><a href="/posts/rf-impairment-2/">Understanding RF Impairments - Part 2</a><li><a href="/posts/fir-fft/">FFT-Based FIR Filtering Using Overlap-Add Method: a Matlab Implementation</a><li><a href="/posts/spectrum1/">Power Spectrum: something I wish I could understand early (1)</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/dsp/">dsp</a> <a class="post-tag" href="/tags/matlab/">matlab</a> <a class="post-tag" href="/tags/interview/">interview</a> <a class="post-tag" href="/tags/impairment/">Impairment</a> <a class="post-tag" href="/tags/power-spectrum/">power spectrum</a> <a class="post-tag" href="/tags/ads-b/">ads-b</a> <a class="post-tag" href="/tags/nonlinear/">nonlinear</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/sampling/">sampling</a> <a class="post-tag" href="/tags/transceiver/">transceiver</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/resample-fourier/"><div class="card-body"> <em class="timeago small" date="2022-05-07 15:00:00 -0700" >May 7, 2022</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Resampling: the Fourier Method</h3><div class="text-muted small"><p> In the last post, we saw how to downsample a signal using the polyphase FIR filter. In fact, the polyphase FIR filter can be used for upsampling as well, or generally speaking, for resampling. In S...</p></div></div></a></div><div class="card"> <a href="/posts/spectrum2/"><div class="card-body"> <em class="timeago small" date="2022-02-12 02:00:00 -0800" >Feb 12, 2022</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Power Spectrum: something I wish I could understand early (2)</h3><div class="text-muted small"><p> Real and complex signals When doing the spectrum analysis, the signal is usually real-valued. However, when studying the baseband signal in wireless communications, the data is complex-valued. The...</p></div></div></a></div><div class="card"> <a href="/posts/spectrum3/"><div class="card-body"> <em class="timeago small" date="2022-02-19 08:00:00 -0800" >Feb 19, 2022</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Power Spectrum: something I wish I could understand early (3)</h3><div class="text-muted small"><p> In this post, I am going to share a set of Python functions that can calculate the power spectral density, spectrogram, and persistence spectrum of a given (real or complex) one-dimensional signal....</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/helium/" class="btn btn-outline-primary" prompt="Older"><p>Helium: IoT on the Blockchain</p></a> <a href="/posts/resample-fourier/" class="btn btn-outline-primary" prompt="Newer"><p>Resampling: the Fourier Method</p></a></div><div id="disqus_thread" class="pt-2 pb-2"><p class="text-center text-muted small"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script type="text/javascript"> var disqus_config = function () { this.page.url = 'https://planewave.github.io/posts/polyphase-decimator/'; this.page.identifier = '/posts/polyphase-decimator/'; }; /* Lazy loading */ var disqus_observer = new IntersectionObserver(function (entries) { if(entries[0].isIntersecting) { (function () { var d = document, s = d.createElement('script'); s.src = 'https://planewave-github-io.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); disqus_observer.disconnect(); } }, { threshold: [0] }); disqus_observer.observe(document.querySelector('#disqus_thread')); /* Auto switch theme */ function reloadDisqus() { /* Disqus hasn't been loaded */ if (typeof DISQUS === "undefined") { return; } if (document.readyState == 'complete') { DISQUS.reset({ reload: true, config: disqus_config }); } } const modeToggle = document.querySelector(".mode-toggle"); if (typeof modeToggle !== "undefined") { /* modeToggle.addEventListener('click', reloadDisqus); // not pretty for 'color-scheme' */ window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', reloadDisqus); } </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://github.com/planewave">Xiao Liu</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/dsp/">dsp</a> <a class="post-tag" href="/tags/matlab/">matlab</a> <a class="post-tag" href="/tags/interview/">interview</a> <a class="post-tag" href="/tags/impairment/">Impairment</a> <a class="post-tag" href="/tags/power-spectrum/">power spectrum</a> <a class="post-tag" href="/tags/ads-b/">ads-b</a> <a class="post-tag" href="/tags/nonlinear/">nonlinear</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/sampling/">sampling</a> <a class="post-tag" href="/tags/transceiver/">transceiver</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-GVBM7G9LZ5"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-GVBM7G9LZ5'); }); </script>
