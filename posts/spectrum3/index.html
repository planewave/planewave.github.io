<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="Power Spectrum: something I wish I could understand early (3)" /><meta property="og:locale" content="en" /><meta name="description" content="In this post, I am going to share a set of Python functions that can calculate the power spectral density, spectrogram, and persistence spectrum of a given (real or complex) one-dimensional signal. The functions are largely based on the Python library: Matplotlib. For demonstration purposes, the original codes are simplified to make them reader-friendly. I want to point out that the implementation of the persistence spectrum is original, and I found this plot is useful and can replace the spectrum in many aspects." /><meta property="og:description" content="In this post, I am going to share a set of Python functions that can calculate the power spectral density, spectrogram, and persistence spectrum of a given (real or complex) one-dimensional signal. The functions are largely based on the Python library: Matplotlib. For demonstration purposes, the original codes are simplified to make them reader-friendly. I want to point out that the implementation of the persistence spectrum is original, and I found this plot is useful and can replace the spectrum in many aspects." /><link rel="canonical" href="https://planewave.github.io/posts/spectrum3/" /><meta property="og:url" content="https://planewave.github.io/posts/spectrum3/" /><meta property="og:site_name" content="Xiao’s Spectrum of Life" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-02-19T08:00:00-08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Power Spectrum: something I wish I could understand early (3)" /><meta name="twitter:site" content="@twitter_username" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"description":"In this post, I am going to share a set of Python functions that can calculate the power spectral density, spectrogram, and persistence spectrum of a given (real or complex) one-dimensional signal. The functions are largely based on the Python library: Matplotlib. For demonstration purposes, the original codes are simplified to make them reader-friendly. I want to point out that the implementation of the persistence spectrum is original, and I found this plot is useful and can replace the spectrum in many aspects.","url":"https://planewave.github.io/posts/spectrum3/","@type":"BlogPosting","headline":"Power Spectrum: something I wish I could understand early (3)","dateModified":"2022-05-18T21:44:35-07:00","datePublished":"2022-02-19T08:00:00-08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://planewave.github.io/posts/spectrum3/"},"@context":"https://schema.org"}</script><title>Power Spectrum: something I wish I could understand early (3) | Xiao's Spectrum of Life</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Xiao's Spectrum of Life"><meta name="application-name" content="Xiao's Spectrum of Life"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/commons/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Xiao's Spectrum of Life</a></div><div class="site-subtitle font-italic">Grow, seek truth courage and wisdom</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/planewave" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://www.linkedin.com/in/xiao-liu-phd" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['exclaim-flip-kooky','duck.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Power Spectrum: something I wish I could understand early (3)</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Power Spectrum: something I wish I could understand early (3)</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/planewave">Xiao Liu</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" date="2022-02-19 08:00:00 -0800" data-toggle="tooltip" data-placement="bottom" title="Sat, Feb 19, 2022, 8:00 AM -0800" >Feb 19, 2022</em> </span> <span> Updated <em class="timeago" date="2022-05-18 21:44:35 -0700 " data-toggle="tooltip" data-placement="bottom" title="Wed, May 18, 2022, 9:44 PM -0700" >May 18, 2022</em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1538 words"> <em>8 min</em> read</span></div></div></div><div class="post-content"><p>In this post, I am going to share a set of Python functions that can calculate the power spectral density, spectrogram, and persistence spectrum of a given (real or complex) one-dimensional signal. The functions are largely based on the Python library: <a href="https://matplotlib.org">Matplotlib</a>. For demonstration purposes, the original codes are simplified to make them reader-friendly. I want to point out that the implementation of the persistence spectrum is original, and I found this plot is useful and can replace the spectrum in many aspects.</p><h2 id="stock-functions">Stock functions <a href="#stock-functions" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>In the beginning, I want to show how to use stock matplotlib functions: <code class="language-plaintext highlighter-rouge">specgram</code> and <code class="language-plaintext highlighter-rouge">psd</code>. For comparison, I will recreate the test signal according to a <a href="https://www.mathworks.com/help/signal/ref/pspectrum.html#mw_a04ca567-c713-4ab1-8a36-94f11eb21e78">Matlab document</a>, where a narrowband signal is embedded within a broadband chirp signal. Keep an eye on the persistence spectrum in the example, and I will talk about it later.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">from</span> <span class="nn">scipy.signal</span> <span class="kn">import</span> <span class="n">windows</span><span class="p">,</span> <span class="n">chirp</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="c1"># generate the signal under test
</span><span class="n">fs</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">fs</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">chirp</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">220</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.15</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">randn</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="n">idx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">floor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="mi">6</span><span class="p">))</span>
<span class="n">x</span><span class="p">[:</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:</span><span class="n">idx</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.05</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="n">pi</span><span class="o">*</span><span class="n">t</span><span class="p">[:</span><span class="n">idx</span><span class="p">]</span><span class="o">*</span><span class="mi">210</span><span class="p">)</span>
</pre></table></code></div></div><p>Then let’s plot the spectrogram and PSD. Under the hood, both of them are generated from the Short-Time Fourier Transform (STFT) of the signal. The process is very similar to the periodogram generation we talked before: in short, the signal is divided into small segments and the FFT is applied to each segment.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="c1"># generate the power spectral density
</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="p">.</span><span class="n">psd</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Fs</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">290</span><span class="p">])</span>
<span class="n">ax</span><span class="p">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">45</span><span class="p">,</span> <span class="o">-</span><span class="mi">15</span><span class="p">])</span>
<span class="n">ax</span><span class="p">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">45</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</pre></table></code></div></div><p><img data-src="/assets/img/posts/plt_psd.png" alt="spd" data-proofer-ignore></p><p>Here I will keep all arguments as default. We can only see the PSD of the wideband chirp signal, and the weak single tone is disappeared.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="c1"># generate the spctrogram
</span><span class="n">figure</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="p">[</span><span class="n">spectrum</span><span class="p">,</span> <span class="n">freqs</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">_</span><span class="p">]</span> <span class="o">=</span> <span class="n">axes</span><span class="p">.</span><span class="n">specgram</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">NFFT</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span> <span class="n">Fs</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span> <span class="n">noverlap</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s">"jet"</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">50</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">axes</span><span class="p">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">290</span><span class="p">])</span>
<span class="n">axes</span><span class="p">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">'Time (minutes)'</span><span class="p">)</span>
<span class="n">axes</span><span class="p">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">'Frequency (Hz)'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</pre></table></code></div></div><p><img data-src="/assets/img/posts/plt_specgram.png" alt="spectrogram" data-proofer-ignore></p><p>Now we can see both signals in the spectrogram. The <code class="language-plaintext highlighter-rouge">overlap</code> argument indicates the number of overlapped samples of two nearby segments, which can reduce the noise interference, at the cost of reduced frequency resolution and more computation. This is a major improvement of Welch’s Method from the original periodogram. I choose “jet” for the color map argument <code class="language-plaintext highlighter-rouge">cmap</code>, because it is the closest to the default Matlab color map.</p><h2 id="spectrogram-and-psd">Spectrogram and PSD <a href="#spectrogram-and-psd" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>To plot our own PSD and spectrogram, we first need two helper functions.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">_stride_windows</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">noverlap</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="s">"""
    a simplified version of matplotlib function with the same name 
    https://github.com/matplotlib/matplotlib/blob/710fce3df95e22701bd68bf6af2c8adbc9d67a79/lib/matplotlib/mlab.py#L218
    more about as_strided function
    https://zhuanlan.zhihu.com/p/64933417
    """</span>
    <span class="n">noverlap</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">noverlap</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

    <span class="n">step</span> <span class="o">=</span> <span class="n">n</span> <span class="o">-</span> <span class="n">noverlap</span>
    <span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">noverlap</span><span class="p">)</span><span class="o">//</span><span class="n">step</span><span class="p">)</span>
    <span class="n">strides</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">strides</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">step</span><span class="o">*</span><span class="n">x</span><span class="p">.</span><span class="n">strides</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">np</span><span class="p">.</span><span class="n">lib</span><span class="p">.</span><span class="n">stride_tricks</span><span class="p">.</span><span class="n">as_strided</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">shape</span><span class="p">,</span> <span class="n">strides</span><span class="o">=</span><span class="n">strides</span><span class="p">)</span>
</pre></table></code></div></div><p>This helper is used to generate signal segments with overlaps. We can also directly reshape the input signal into a two-dimensional matrix if no overlap is required.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">_spectral_helper</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Fs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">NFFT</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span> <span class="n">noverlap</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="s">"""
    spectrual help for spectrum, spectrogram, and persistence spectrum
    NFFT is assumed to be the power of 2, at least is an even number
    """</span>
    <span class="c1"># segmentation and windowing
</span>    <span class="c1"># window = np.hanning(NFFT)
</span>    <span class="c1"># Kaiser window is used in Matlab
</span>    <span class="n">window</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">kaiser</span><span class="p">(</span><span class="n">NFFT</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">_stride_windows</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">NFFT</span><span class="p">,</span> <span class="n">noverlap</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">result</span> <span class="o">*</span> <span class="n">window</span><span class="p">.</span><span class="n">reshape</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="c1"># fft to each frame
</span>    <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">fft</span><span class="p">.</span><span class="n">fft</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">NFFT</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="c1"># convert to power
</span>    <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">conj</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="o">*</span> <span class="n">result</span><span class="p">)</span>
    <span class="n">freqs</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">fft</span><span class="p">.</span><span class="n">fftfreq</span><span class="p">(</span><span class="n">NFFT</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">Fs</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">np</span><span class="p">.</span><span class="n">iscomplex</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="c1"># twosided
</span>        <span class="c1"># center the frequency range at zero (fftshift)
</span>        <span class="n">freqs</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">fft</span><span class="p">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">freqs</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">fft</span><span class="p">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># onesided
</span>        <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="p">[:</span><span class="n">NFFT</span><span class="o">//</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>
        <span class="c1"># scale for onesided spectrum, skip the DC
</span>        <span class="n">result</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="p">:]</span> <span class="o">*=</span> <span class="mi">2</span>
        <span class="n">freqs</span> <span class="o">=</span> <span class="n">freqs</span><span class="p">[:</span><span class="n">NFFT</span><span class="o">//</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
        <span class="c1"># get the last value correctly, it is negative otherwise
</span>        <span class="n">freqs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>

    <span class="c1"># divides by the sampling frequency so that density function has 
</span>    <span class="c1"># units of dB/Hz and can be integrated by the plotted frequency value
</span>    <span class="n">result</span> <span class="o">/=</span> <span class="n">Fs</span>
    <span class="c1"># Scale the spectrum by the norm of the window to compensate for
</span>    <span class="c1"># windowing loss; see Bendat &amp; Piersol Sec 11.5.2.
</span>    <span class="n">result</span> <span class="o">/=</span> <span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nb">abs</span><span class="p">(</span><span class="n">window</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">).</span><span class="nb">sum</span><span class="p">()</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="n">NFFT</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">NFFT</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NFFT</span> <span class="o">-</span> <span class="n">noverlap</span><span class="p">)</span><span class="o">/</span><span class="n">Fs</span>

    <span class="k">return</span> <span class="n">result</span><span class="p">,</span> <span class="n">freqs</span><span class="p">,</span> <span class="n">t</span>
</pre></table></code></div></div><p>This is the core function of STFT computation. It processes the signal in the following steps:</p><ol><li>Each data segment is multiplied by the Kaiser window.<li>Apply FFT to each segment and convert it to power.<li>For complex signals, shift the result such that the DC is in the middle; for real signals, discard the negative frequency components and double the positive components.<li>Normalize the results by the sampling frequency and the energy of the window.</ol><p>Make sure to follow all the steps to get the right power value.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="n">Fs</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">NFFT</span> <span class="o">=</span> <span class="mi">1024</span>
<span class="n">noverlap</span> <span class="o">=</span> <span class="mi">782</span>
<span class="n">result</span><span class="p">,</span> <span class="n">freqs</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">_spectral_helper</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Fs</span><span class="p">,</span> <span class="n">NFFT</span><span class="o">=</span><span class="n">NFFT</span><span class="p">,</span> <span class="n">noverlap</span><span class="o">=</span><span class="n">noverlap</span><span class="p">)</span>
<span class="n">psd</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="n">log10</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freqs</span><span class="p">,</span> <span class="n">psd</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">'Frequency'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">'Power Spectral Density (dB/Hz)'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">290</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</pre></table></code></div></div><p>So the PSD can be derived from the STFT result by averaging in time. Don’t forget to convert it to the <strong>dB</strong> scale.</p><p>Next is the spectrogram.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre><span class="n">stft</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="n">log10</span><span class="p">(</span><span class="n">result</span> <span class="o">+</span> <span class="mf">1e-6</span><span class="p">)</span>
<span class="c1"># find the extent in time and freq
</span><span class="n">pad_xextent</span> <span class="o">=</span> <span class="p">(</span><span class="n">NFFT</span><span class="o">-</span><span class="n">noverlap</span><span class="p">)</span> <span class="o">/</span> <span class="n">Fs</span> <span class="o">/</span> <span class="mi">2</span>
<span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nb">min</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="n">pad_xextent</span><span class="p">,</span> <span class="n">np</span><span class="p">.</span><span class="nb">max</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">pad_xextent</span>
<span class="n">extent</span> <span class="o">=</span> <span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">freqs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">freqs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="n">pwr_min</span><span class="p">,</span> <span class="n">pwr_max</span> <span class="o">=</span> <span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="mi">0</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="p">.</span><span class="n">imshow</span><span class="p">(</span>
    <span class="n">stft</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s">"jet"</span><span class="p">,</span> 
    <span class="n">extent</span><span class="o">=</span><span class="n">extent</span><span class="p">,</span> 
    <span class="n">vmin</span><span class="o">=</span><span class="n">pwr_min</span><span class="p">,</span> 
    <span class="n">vmax</span><span class="o">=</span><span class="n">pwr_max</span><span class="p">,</span> 
    <span class="n">origin</span><span class="o">=</span><span class="s">'lower'</span>
<span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">290</span><span class="p">])</span>
<span class="n">ax</span><span class="p">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">'Frequency'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">'time'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</pre></table></code></div></div><p>It is basically to use <code class="language-plaintext highlighter-rouge">imshow()</code> to display the STFT results. However, there are some tricky points:</p><ol><li>The linear STFT value is converted to the dB scale. Note that you can only average the linear scaled STFT results, therefore, I can’t do it before the PSD plotting.<li>The added small number, 1e-6 into linear scaled STFT is to avoid the potential log(0) that gives us negative infinity.<li>Manually decide the “extent” and “vmin”, “vmax” to get the best <code class="language-plaintext highlighter-rouge">imshow()</code> display range.<li>Don’t forget to set the “origin” argument to “lower”, otherwise, the default will make the frequency axis flip.</ol><p>The plots are alomst identical to the plots above, so I will not paste them twice.</p><h2 id="persistence-spectrum">Persistence spectrum <a href="#persistence-spectrum" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>The persistence spectrum is a beautiful way to display the time-variant signals. Someone call it <a href="https://teaandtechtime.com/python-intensity-graded-fft-plots/">intensity graded persistence display</a>. I want to again quote this <a href="https://www.mathworks.com/help/signal/ug/persistence-spectrum-in-signal-analyzer.html">Matlab document</a> to explain it:</p><blockquote><p>The persistence spectrum of a signal is a time-frequency view that shows the percentage of the time that a given frequency is present in a signal. The persistence spectrum is a histogram in power-frequency space. The longer a particular frequency persists in a signal as the signal evolves, the higher its time percentage and thus the brighter or “hotter” its color in the display. Use the persistence spectrum to identify signals hidden in other signals.</p></blockquote><p>So, it is a histogram of the STFT results, I am going to use <code class="language-plaintext highlighter-rouge">np.histogram()</code> function to plot it:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre><span class="n">nbins</span> <span class="o">=</span> <span class="mi">256</span>
<span class="n">pspectrum</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nbins</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">freqs</span><span class="p">)))</span>
<span class="k">for</span> <span class="n">idx_f</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">freqs</span><span class="p">)):</span>
    <span class="n">pspectrum</span><span class="p">[:,</span> <span class="n">idx_f</span><span class="p">],</span> <span class="n">_</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">histogram</span><span class="p">(</span>
        <span class="n">stft</span><span class="p">[</span><span class="n">idx_f</span><span class="p">,</span> <span class="p">:],</span> 
        <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">pwr_min</span><span class="p">,</span> <span class="n">pwr_max</span><span class="p">,</span> <span class="n">nbins</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span>
        <span class="n">density</span><span class="o">=</span><span class="bp">False</span>
    <span class="p">)</span>
<span class="n">pspectrum</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">log</span><span class="p">(</span><span class="n">pspectrum</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="p">.</span><span class="n">imshow</span><span class="p">(</span>
    <span class="n">pspectrum</span><span class="p">,</span>
    <span class="n">aspect</span><span class="o">=</span><span class="s">"auto"</span><span class="p">,</span>
    <span class="n">cmap</span><span class="o">=</span><span class="s">"jet"</span><span class="p">,</span>
    <span class="n">extent</span><span class="o">=</span><span class="p">(</span><span class="n">freqs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">freqs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">pwr_min</span><span class="p">,</span> <span class="n">pwr_max</span><span class="p">),</span>
    <span class="n">origin</span><span class="o">=</span><span class="s">'lower'</span><span class="p">,</span>
    <span class="c1"># vmin=-1,
</span>    <span class="c1"># vmax=3.
</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">290</span><span class="p">])</span>
<span class="n">ax</span><span class="p">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">'Frequency (Hz)'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">'Power Spectrum (dB/Hz)'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</pre></table></code></div></div><p>For each frequency slot, I generate a histogram from the log STFT result. To enhance the low power signals, another log is applied to the histogram result. Finally, use the <code class="language-plaintext highlighter-rouge">imshow()</code> function to plot the persistence spectrum just like the spectrogram.</p><p><img data-src="/assets/img/posts/plt_psp.png" alt="persistence spectrum" data-proofer-ignore></p><p>Now, we can see both signals in the persistence spectrum. That is why I prefer it over the normal PSD plot.</p><h2 id="noise-floor-issue">Noise floor issue <a href="#noise-floor-issue" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>But if you take a look at the noise floor of my plot, it is about 6 dB lower than the plot from Matlab’s document. It confused me for quite a while. After a few unsuccessful communication with Mathworks after service, I finally found the reason.</p><p><img data-src="/assets/img/posts/PersistenceSpectrumOfTransientExample_03.png" alt="Persistence Spectrum from Matlab" data-proofer-ignore></p><p>In my plot, the unit of the power is dB/Hz, in other words, the power is measured in a frequency bin of 1 Hz. And the plot from Matlab has a frequency resolution of about 4 Hz, so the power is measured in a frequency bin of 4 Hz. That is why the unit on the y-axis only says dB, not dB/Hz as it used to be. Therefore, the power measure in Matlab’s plot is 4 times higher (6 dB) higher than my plot. Mysteries solved!</p><h2 id="its-all-yours">It’s all yours <a href="#its-all-yours" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>you can download and/or test my code <a href="https://colab.research.google.com/drive/1fElyFAiaiclX3kfWah2ilmOFXy2ZmuEV?usp=sharing">here</a>. I think this concludes today’s post. See you next time.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/dsp-essentials/'>DSP essentials</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/dsp/" class="post-tag no-text-decoration" >dsp</a> <a href="/tags/power-spectrum/" class="post-tag no-text-decoration" >power spectrum</a> <a href="/tags/python/" class="post-tag no-text-decoration" >python</a> <a href="/tags/matlab/" class="post-tag no-text-decoration" >matlab</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Power Spectrum: something I wish I could understand early (3) - Xiao's Spectrum of Life&url=https://planewave.github.io/posts/spectrum3/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Power Spectrum: something I wish I could understand early (3) - Xiao's Spectrum of Life&u=https://planewave.github.io/posts/spectrum3/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Power Spectrum: something I wish I could understand early (3) - Xiao's Spectrum of Life&url=https://planewave.github.io/posts/spectrum3/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recent Update</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Chinese-new-year/">除夕夜的回忆</a><li><a href="/posts/new-year/">Happy New Year!</a><li><a href="/posts/rf-impairment-2/">Understanding RF Impairments - Part 2</a><li><a href="/posts/fir-fft/">FFT-Based FIR Filtering Using Overlap-Add Method: a Matlab Implementation</a><li><a href="/posts/spectrum1/">Power Spectrum: something I wish I could understand early (1)</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/dsp/">dsp</a> <a class="post-tag" href="/tags/matlab/">matlab</a> <a class="post-tag" href="/tags/interview/">interview</a> <a class="post-tag" href="/tags/impairment/">Impairment</a> <a class="post-tag" href="/tags/power-spectrum/">power spectrum</a> <a class="post-tag" href="/tags/ads-b/">ads-b</a> <a class="post-tag" href="/tags/nonlinear/">nonlinear</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/sampling/">sampling</a> <a class="post-tag" href="/tags/transceiver/">transceiver</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/spectrum1/"><div class="card-body"> <em class="timeago small" date="2022-02-01 02:00:00 -0800" >Feb 1, 2022</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Power Spectrum: something I wish I could understand early (1)</h3><div class="text-muted small"><p> Other than the time plot, the power spectrum and the spectrogram (a plot that shows the signal in time and frequency domain) are probably the most important tools for digital signal analysis. Becau...</p></div></div></a></div><div class="card"> <a href="/posts/spectrum2/"><div class="card-body"> <em class="timeago small" date="2022-02-12 02:00:00 -0800" >Feb 12, 2022</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Power Spectrum: something I wish I could understand early (2)</h3><div class="text-muted small"><p> Real and complex signals When doing the spectrum analysis, the signal is usually real-valued. However, when studying the baseband signal in wireless communications, the data is complex-valued. The...</p></div></div></a></div><div class="card"> <a href="/posts/polyphase-decimator/"><div class="card-body"> <em class="timeago small" date="2022-04-23 02:00:00 -0700" >Apr 23, 2022</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Polyphase FIR Filter Downsampling</h3><div class="text-muted small"><p> This is a long-delayed post. As a father of two, who is living in one of the most expensive cities in the world, life is full of challenges. In most cases, after decomposition, they always go down ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/spectrum2/" class="btn btn-outline-primary" prompt="Older"><p>Power Spectrum: something I wish I could understand early (2)</p></a> <a href="/posts/wifi800/" class="btn btn-outline-primary" prompt="Newer"><p>Why do I receive a Wi-Fi signal at 810 MHz?</p></a></div><div id="disqus_thread" class="pt-2 pb-2"><p class="text-center text-muted small"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script type="text/javascript"> var disqus_config = function () { this.page.url = 'https://planewave.github.io/posts/spectrum3/'; this.page.identifier = '/posts/spectrum3/'; }; /* Lazy loading */ var disqus_observer = new IntersectionObserver(function (entries) { if(entries[0].isIntersecting) { (function () { var d = document, s = d.createElement('script'); s.src = 'https://planewave-github-io.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); disqus_observer.disconnect(); } }, { threshold: [0] }); disqus_observer.observe(document.querySelector('#disqus_thread')); /* Auto switch theme */ function reloadDisqus() { /* Disqus hasn't been loaded */ if (typeof DISQUS === "undefined") { return; } if (document.readyState == 'complete') { DISQUS.reset({ reload: true, config: disqus_config }); } } const modeToggle = document.querySelector(".mode-toggle"); if (typeof modeToggle !== "undefined") { /* modeToggle.addEventListener('click', reloadDisqus); // not pretty for 'color-scheme' */ window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', reloadDisqus); } </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://github.com/planewave">Xiao Liu</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/dsp/">dsp</a> <a class="post-tag" href="/tags/matlab/">matlab</a> <a class="post-tag" href="/tags/interview/">interview</a> <a class="post-tag" href="/tags/impairment/">Impairment</a> <a class="post-tag" href="/tags/power-spectrum/">power spectrum</a> <a class="post-tag" href="/tags/ads-b/">ads-b</a> <a class="post-tag" href="/tags/nonlinear/">nonlinear</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/sampling/">sampling</a> <a class="post-tag" href="/tags/transceiver/">transceiver</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-GVBM7G9LZ5"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-GVBM7G9LZ5'); }); </script>
